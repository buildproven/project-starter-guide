# Gitleaks configuration for comprehensive secret detection
# Generated by create-qa-architect

[extend]
# Use default gitleaks rules as base
useDefault = true

# Additional custom patterns for common secrets
[[rules]]
description = "JWT tokens"
id = "jwt-token"
regex = '''eyJ[A-Za-z0-9_/+-]{10,}={0,2}'''
tags = ["key", "JWT"]

[[rules]]
description = "Environment variable secrets"
id = "env-secret"
regex = '''(?i)(api_key|secret|password|token)\s*=\s*['""][^'"\s]{10,}['""]'''
tags = ["env", "secret"]

# Allowlist for test files and examples
[rules.allowlist]
description = "Test secrets and examples"
regexes = [
  '''test_secret_.*''',
  '''example_.*''',
  '''dummy_.*''',
  '''fake_.*'''
]
paths = [
  '''tests/''',
  '''test/''',
  '''__tests__/''',
  '''examples/''',
  '''docs/''',
  '''.md$'''
]

# Global allowlist for common false positives
[allowlist]
description = "Common false positives"
regexes = [
  '''EXAMPLE_.*''',
  '''your_.*_here''',
  '''replace_with_.*''',
  '''TODO:.*'''
]
paths = [
  '''node_modules''',
  '''\.npm-cache''',
  '''\.next''',
  '''dist''',
  '''\.claude-setup'''
]
